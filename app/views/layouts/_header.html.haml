%header.header
  %div
    .header--primary
      .container
        =link_to root_url, class: "brand" do 
          .logo
            %i.fa.fa-fast-forward
          .brand--title.u-hidden-on-small-screen
            %h1= link_to "FastForward", root_url
            %h5 The latest research, delivered to your inbox
        %ul.header--nav
          - if user_signed_in?
            %li.btn= link_to "Log Out", destroy_user_session_path, method: 'delete'
            %li.profile-img= image_tag(current_user.image)
          -else
            %li.btn= link_to "Log In", user_omniauth_authorize_path(:facebook)
        %li.u-hidden-on-small-screen
          %a.header--post(href="#")
            / %svg(width="50" height="50")
            / %circle(cx="25" cy="25" r="20" stroke="green" stroke-width="2" fill="yellow")
    .header--secondary.v-links
      .container
        %a.header--secondary--link
          =button_to root_path, method: "get", class: "btn btn-gray", id: ("active" if request.path == '/') do
            Research Questions

        %a.header--secondary--link#following
          -if user_signed_in?
            =button_to subscriptions_path, method: "get", class: "btn btn-gray", id: ("active" if request.path == '/subscriptions') do
              %i.fa.fa-plus-circle
              My Subscriptions
              %span#user-follow-count= "(#{current_user.lists.count})"
          -else
            %button.btn.btn-gray{"data-target" => "#myModal", "data-toggle" => "modal", :type => "button"}
              %i.fa.fa-plus-circle
              My Subscriptions
            =render partial: 'shared/sign_in_modal'
        - if request.env['PATH_INFO'] == '/'
          .btn-group#filter
            %button.btn.btn-default.dropdown-toggle(type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false")
              %span#filter-display-name
                - if @tag
                  = @tag.name
                - else 
                  All topics
              %span.caret
            %ul.dropdown-menu#tag-dropdown-menu
              %li= link_to "All topics", lists_path, remote: true
              - Tag.all.each do |tag|
                - if tag.lists.count > 0
                  %li= link_to tag.name, tag_path(tag), class: "tag-" + tag.name, remote: true




/ %nav.navbar.navbar-inverse.navbar-fixed-top{role:"navigation"}
/   .navbar-header
/     =link_to root_url, class:"navbar-brand", id:"logo" do
/       %i.fa.fa-globe
/       Development Economics GPS

/   %ul.nav.navbar-right.top-nav
/     %li.search
/       %input.search-bar{autocomplete: "off", id: "q", placeholder: "Search your research interest (e.g. school vouchers)", type: "text", spellcheck: "false"}
/     - if current_user.try(:admin?)
/       %li.btn.btn-default.btn-primary= link_to "Sign out", destroy_user_session_path, method: 'delete'

/ .container-fluid.sub-nav
/   .row.child-collections
/     %ul
/       -if @collection && !@collection.new_record?

/         %li.child
/           = link_to "All", @collection.root, class: ("highlight" if @collection == @collection.root)
/         -@collection.root.children.each do |child|
/           %li.child= link_to child.name, child, class: ("highlight" if @collection == child)
/       -else
/         %li.child= link_to "Home", root_url, class: ("highlight" if request.original_url == root_url)
/         %li.child= link_to "FAQ", static_pages_about_url, class: ("highlight" if request.original_url == static_pages_about_url)
/         %li.child= link_to "People", static_pages_people_url, class: ("highlight" if request.original_url == static_pages_people_url)

:javascript
  $('.collection').click( function() {
    $text =($(this).text());
    mixpanel.track("Visited collection", {
      "Collection": $text,
      "Relation": "Root"
    });
  });
  $('.header--secondary--link button').click(function() {
    mixpanel.track("Visit subheader link", {
      "Link": $('this').text()
    });
  })
  $('.header--nav li a').click(function() {
    mixpanel.track("Log in/out", {
      "Type": $('this').text()
    })
  })
  $('#filter button').click(function() {
    mixpanel.track("Filter by topic");
  })
  $('.child').click( function() {
    $text = ($(this).text());
    mixpanel.track("Visited collection", {
      "Collection": $text,
      "Relation": "Child"
    })
  })
  $('.dropdown-menu li').click( function() {
    $text = $(this).text();
    $('#filter-display-name').text($text);
  })






